const TYPES = {
  "moon_cat": {
    "label": "🌙 月ネコ｜Moon Cat",
    "img": "assets/moon_cat.png",
    "catch": "静かに深く、自分の世界を生きる人",
    "personality": [
      "感受性が高く、内側で物事を深く咀嚼する",
      "少人数・ひとり時間で本領発揮。静かな環境ほど集中できる",
      "違和感や空気の変化に敏感で、先回りして調整しがち",
      "考えがまとまるまで話さないが、言葉にした時の説得力が強い",
      "『無理して明るく』より『落ち着いて正直』が魅力として伝わるタイプ"
    ],
    "work": [
      "企画・デザイン・文章・研究など「深掘り系」に強い",
      "品質を上げる改善や、レビュー・校正・監修など精度が必要な仕事が得意",
      "裁量があり、静かに集中できる環境が◎（締切が明確だとさらに良い）",
      "評価されるコツ：途中経過を小出しに共有すると安心感が上がる"
    ],
    "love": [
      "月ネコタイプのあなたは、恋愛においてとても慎重で一途。すぐに距離を縮めるより、相手をよく観察し「この人なら大丈夫」と確信してから心を開きます。一度好きになると長く想い続ける反面、気持ちを言葉にするのは少し苦手。理解してくれる相手や、静かな時間を共有できる関係で本当の魅力が輝きます。"
    ],
    "best": [
      "forest_rabbit",
      "sage_lion"
    ],
    "cardSummary": "静かな集中で本領発揮。深く考える一途タイプで、距離感を大切にしながら信頼で関係を育てる。気持ちは少しずつ言葉にすると恋が安定。無理せず自分のペースが吉。静かな好意が最強。"
  },
  "dream_cat": {
    "label": "🌌 夢ネコ｜Dream Cat",
    "img": "assets/dream_cat.png",
    "catch": "想像力で世界を広げるクリエイター",
    "personality": [
      "妄想力・世界観が豊かで、アイデアが連鎖的に広がる",
      "気分や感情の波があるぶん、ハマった時の爆発力が大きい",
      "人の言葉のニュアンスや空気感に敏感で、表現に落とし込める",
      "現実の細部より“全体の雰囲気”を優先して考える",
      "好きなものが明確。『好き』を語る時がいちばん魅力的"
    ],
    "work": [
      "クリエイティブ職・発想勝負の分野で才能が出る",
      "コンセプト設計、ネーミング、企画案出し、ビジュアルの方向性決めが得意",
      "型にはめられない環境で開花。自由度＋締切の組み合わせが最強",
      "評価されるコツ：アイデアを“1枚の資料/箇条書き”に落とすと伝わりやすい"
    ],
    "love": [
      "夢ネコタイプは、恋愛にロマンと物語性を求めるタイプ。現実的な条件よりも「一緒にいる時の世界観」や感情の共鳴を重視します。理想が高く、気持ちが盛り上がると一気にのめり込みやすい反面、夢を否定されると一瞬で心を閉ざすことも。共感力のある相手となら、深く特別な関係を築けます。"
    ],
    "best": [
      "festival_dog",
      "wisdom_rabbit"
    ],
    "cardSummary": "世界観と共感が恋の鍵。ロマンを大事にし、気持ちが乗ると一気に加速。理想を笑わず受け止めてくれる相手と相性◎。現実の段取りは小さく仕組み化がコツ。ときめきを守ってね。"
  },
  "mist_cat": {
    "label": "🫧 霧ネコ｜Mist Cat",
    "img": "assets/mist_cat.png",
    "catch": "空気と感情を読む共感マスター",
    "personality": [
      "人の感情に敏感で、相手の変化にいち早く気づく",
      "場の空気を整えるのが自然にできる。衝突をやわらげる存在",
      "共感が深いぶん、相手の痛みを自分のことのように抱えやすい",
      "『察して動く』が得意だが、言語化は意識しないと後回しになりがち",
      "優しさが武器。安心感を与えるだけで周りが落ち着く"
    ],
    "work": [
      "接客・相談役・サポート業務など、人の温度感が大事な仕事に強い",
      "CS/受付/マネージャー補佐など“困りごと回収”が得意",
      "気配り力が評価される職場向き。ただし抱え込み過ぎはNG",
      "評価されるコツ：『できる範囲』を先に宣言すると疲弊しにくい"
    ],
    "love": [
      "霧ネコタイプは、相手の気持ちに自然と寄り添ってしまう恋愛体質。好きな人の感情を優先し、自分のことは後回しになりがちです。「相手が幸せならそれでいい」と思える優しさが魅力ですが、無理をしすぎると心が疲れてしまいます。あなたを気遣い、安心させてくれる相手となら、穏やかな愛が育ちます。"
    ],
    "best": [
      "wind_rabbit",
      "sun_dog"
    ],
    "cardSummary": "相手の気持ちに寄り添う優しさが魅力。尽くし過ぎると疲れやすいので境界線を意識。『NO』を言えると愛が続く。安心させてくれる相手で穏やかに安定しやすい。自分の心も最優先で。"
  },
  "forest_rabbit": {
    "label": "🌿 森ウサギ｜Forest Rabbit",
    "img": "assets/forest_rabbit.png",
    "catch": "信頼される縁の下の力持ち",
    "personality": [
      "丁寧・誠実・コツコツ型。積み上げで信頼を作る",
      "約束やルールを守ることで安心感を提供できる",
      "派手さはないが安定感があり、周囲の基盤になりやすい",
      "変化は慎重に見極めるが、一度決めたら継続力が強い",
      "周りのために頑張りすぎる時があるので休息が大事"
    ],
    "work": [
      "事務・管理・継続業務に強い。ミスが少なく再現性が高い",
      "チェックリスト運用、在庫/数値管理、ルーティン改善などが得意",
      "安心して任せられる人材。『縁の下』だが成果が大きい",
      "評価されるコツ：成果を見える化（件数・短縮時間）すると報われやすい"
    ],
    "love": [
      "森ウサギタイプは、恋愛においても安定と信頼を大切にするタイプ。派手な駆け引きや刺激より、日常の積み重ねを重視します。一途で誠実なので、付き合うほどに信頼度が増していく存在。ただし自分の希望を我慢しがちなので、対等に話し合える関係を意識すると、より幸せな恋愛になります。"
    ],
    "best": [
      "moon_cat",
      "shogun_lion"
    ],
    "cardSummary": "誠実で安定志向。派手さより日常の積み重ねで信頼が深まる。遠慮しすぎず本音を言える関係が、長く幸せを守る鍵。安心をくれる人ほど大切にし、甘える練習も◎。安心は才能。"
  },
  "wind_rabbit": {
    "label": "🍃 風ウサギ｜Wind Rabbit",
    "img": "assets/wind_rabbit.png",
    "catch": "人と人をつなぐバランサー",
    "personality": [
      "状況把握が得意で、全体のバランスを取るのが上手い",
      "対立を和らげる調整役。誰かの“言いづらい本音”を拾える",
      "視野が広く、今必要な優先順位を自然に組み替えられる",
      "自分の意見は後回しになりがち。気づくと疲れていることも",
      "中立でいられるのが強み。信頼されるとチームが安定する"
    ],
    "work": [
      "チーム調整・進行管理・橋渡しで真価を発揮",
      "会議設計、タスク整理、関係者の合意形成が得意",
      "仲介役として“詰まり”をほぐせる。トラブル予防にも強い",
      "評価されるコツ：自分の工数も記録し、抱え込みを防ぐ"
    ],
    "love": [
      "風ウサギタイプは、恋愛でも相手に合わせるのがとても上手。相手のペースや気分を察し、自然と心地よい距離感を作れます。その反面、自分の本音を後回しにしてしまう傾向も。「嫌われたくない」より「大切にされたい」を基準にすると、無理のない愛情バランスを保てる恋愛ができます。"
    ],
    "best": [
      "mist_cat",
      "king_lion"
    ],
    "cardSummary": "調整上手で相手に合わせられるが本音は後回しにしがち。『大切にされたい』を基準に、対等な距離感を作ると恋が安定。気持ちを小出しに伝えるほど誤解が減って深まる。本音が恋を育てる。"
  },
  "wisdom_rabbit": {
    "label": "📘 知恵ウサギ｜Wisdom Rabbit",
    "img": "assets/wisdom_rabbit.png",
    "catch": "静かに全体を見ている参謀",
    "personality": [
      "情報整理・分析が得意で、筋道立てて考える参謀タイプ",
      "感情より理解を優先し、物事を冷静に分解できる",
      "一歩引いた視点を持ち、全体の矛盾や抜け漏れに気づく",
      "口数は多くないが、発言は核心を突く",
      "丁寧に説明できるほど信頼が増える。教えるのも上手い"
    ],
    "work": [
      "データ・分析・企画補佐、設計レビューなど“考える仕事”で強い",
      "要件整理、仕様作り、手順化、マニュアル作成が得意",
      "裏方ポジションで全体の精度を上げる役割が向く",
      "評価されるコツ：結論→理由→次アクションの順で共有すると伝わりやすい"
    ],
    "love": [
      "知恵ウサギタイプは、恋愛でも冷静に相手を見極めるタイプ。感情だけで突っ走ることは少なく、会話や価値観の一致を重視します。一見クールに見られがちですが、内側では深く考えています。気持ちを言葉にすることを意識すると、誤解が減り、より信頼の深い関係を築けます。"
    ],
    "best": [
      "dream_cat",
      "sage_lion"
    ],
    "cardSummary": "冷静に見極め、会話と価値観の一致を重視。クールに見えて実は深い。気持ちを言葉にすると誤解が減り信頼が増す。議論より共有を意識すると、安心感が一気に上がる。言葉は愛の橋。"
  },
  "sun_dog": {
    "label": "🔥 太陽イヌ｜Sun Dog",
    "img": "assets/sun_dog.png",
    "catch": "場を明るくするエネルギー源",
    "personality": [
      "行動力と熱量が武器。雰囲気を一気に明るくできる",
      "考えるより動くタイプで、停滞を突破する起爆剤になる",
      "感情表現がストレートで、裏表が少ない",
      "周りを巻き込むのが得意。応援されるとさらに伸びる",
      "反省より切り替えが早い。挑戦回数が増えるほど強くなる"
    ],
    "work": [
      "営業・イベント・現場系で強い。スピード感ある環境向き",
      "対人コミュニケーション、提案、プレゼンで力を発揮",
      "“まずやってみる”文化のチームで成果が出やすい",
      "評価されるコツ：やる前にゴールを一言で宣言すると成功率UP"
    ],
    "love": [
      "太陽イヌタイプは、恋愛においても感情表現がストレート。好きになったら一直線で、愛情を隠しません。一緒に楽しむ時間を大切にし、相手を明るく照らす存在です。ただし勢い任せになりやすいので、相手のペースを尊重できると、長続きする恋愛になります。"
    ],
    "best": [
      "mist_cat",
      "forest_rabbit"
    ],
    "cardSummary": "愛情表現がストレートで、一緒に楽しむのが得意。勢いだけにならないよう相手のペースも尊重すると、熱量が長続きに変わる。褒め言葉と感謝を増やすほど、恋の運気が上がる。"
  },
  "thunder_dog": {
    "label": "⚡ 稲妻イヌ｜Thunder Dog",
    "img": "assets/thunder_dog.png",
    "catch": "突破力の塊チャレンジャー",
    "personality": [
      "刺激を求めるチャレンジャー。変化があるほど燃える",
      "失敗を恐れず試行回数が多い。突破力が高い",
      "単調な作業は苦手だが、短期集中は得意",
      "決めたら早い。迷う時間より行動で答えを出す",
      "自由を大切にする。縛られるとモチベが落ちやすい"
    ],
    "work": [
      "新規事業・変化のある現場・スタートアップ気質の仕事に強い",
      "0→1の立ち上げ、改善施策、企画の実験運用が得意",
      "スピード×仮説検証で成果を出すタイプ",
      "評価されるコツ：やりっぱなし防止に“振り返りテンプレ”を持つと最強"
    ],
    "love": [
      "稲妻イヌタイプは、刺激とドキドキを求める恋愛スタイル。新鮮さや変化がないと物足りなく感じやすいタイプです。自由を大切にするため、束縛が強い関係は苦手。お互いの挑戦を応援し合える関係や、程よい距離感を保てる相手と相性が良いでしょう。"
    ],
    "best": [
      "wind_rabbit",
      "shogun_lion"
    ],
    "cardSummary": "刺激と自由が必要な挑戦型。束縛は苦手だが、応援し合える関係なら最強。新鮮さを保つ工夫が恋を続けるポイント。予定やルールは“ゆるく共有”がちょうどいい。自由は愛の酸素。"
  },
  "festival_dog": {
    "label": "🎉 祭イヌ｜Festival Dog",
    "img": "assets/festival_dog.png",
    "catch": "人を集めるムードメーカー",
    "personality": [
      "社交性が高く、人を集めて場を作るムードメーカー",
      "発信力・拡散力があり、周りの温度を上げられる",
      "初対面でも距離を縮めるのが上手い",
      "一人時間は短め。人と動くほど元気になる",
      "楽しいことに敏感。空気が重い時の“突破口”になれる"
    ],
    "work": [
      "広報・SNS・接客・コミュニティ運営など“人前”で強い",
      "告知、イベント集客、ファンづくり、口コミ設計が得意",
      "人の心を動かす表現が武器。顔出し/登壇も向く",
      "評価されるコツ：数字（反応率・来店数）を追うとさらに伸びる"
    ],
    "love": [
      "祭イヌタイプは、恋愛も「楽しいかどうか」が最優先。一緒に笑って過ごせる時間を何より大切にします。人とのつながりが多く、誤解されやすい一面もありますが、本質はとても素直。自由と信頼を与えてくれる相手となら、明るい恋愛が続きます。"
    ],
    "best": [
      "dream_cat",
      "king_lion"
    ],
    "cardSummary": "楽しい時間が恋の栄養。社交的で誤解されやすいが本質は素直。自由と信頼をくれる相手と、明るく前向きに続く。約束は短く明確にすると安心感が増え、関係が安定する。笑顔が武器。"
  },
  "king_lion": {
    "label": "👑 王ライオン｜King Lion",
    "img": "assets/king_lion.png",
    "catch": "決断で道を作るリーダー",
    "personality": [
      "責任感・決断力が高く、自然と中心になりやすい",
      "迷いが少なく、判断で道を作るリーダー気質",
      "弱みを見せにくいが、内側では人を守りたい気持ちが強い",
      "目的が明確だと爆発的に強い。逆に曖昧さはストレス",
      "信頼されるほど力が出る。任されると燃えるタイプ"
    ],
    "work": [
      "管理職・統括・プロジェクトオーナーで本領発揮",
      "意思決定、優先順位付け、リソース配分が得意",
      "任されるほど燃える。チームの旗振り役に向く",
      "評価されるコツ：『任せる範囲』を切ると抱え込みが減ってさらに強い"
    ],
    "love": [
      "王ライオンタイプは、恋愛でも主導権を持ちやすいタイプ。守る意識が強く、責任感のある関係を築こうとします。弱みを見せるのが少し苦手で、強く見られがちですが、心を許した相手には深い愛情を注ぎます。尊敬し合える関係が長続きの鍵です。"
    ],
    "best": [
      "festival_dog",
      "moon_cat"
    ],
    "cardSummary": "責任感が強く主導権を握りやすい。弱みは見せにくいが一途で深い愛。尊敬し合い、頼る勇気を持つと関係が強くなる。『任せる・甘える』を少し増やすと恋が柔らかく続く。優しさも強さ。"
  },
  "sage_lion": {
    "label": "🦁 賢者ライオン｜Sage Lion",
    "img": "assets/sage_lion.png",
    "catch": "全体を読む頭脳派",
    "personality": [
      "論理・戦略重視で、全体を俯瞰して設計できる頭脳派",
      "感情に流されにくく、冷静な判断役になれる",
      "先を読むのが得意で、リスクを事前に潰す",
      "言葉選びがシャープ。説明が的確だと信頼が増える",
      "合理性が強い分、気持ちの共有は意識すると◎"
    ],
    "work": [
      "企画設計・戦略立案・数字や構造を扱う仕事に強い",
      "KPI設計、導線改善、仕組み化、意思決定資料の作成が得意",
      "長期計画と短期施策をつなぐのが上手い",
      "評価されるコツ：『相手のメリット』を先に提示すると通りやすい"
    ],
    "love": [
      "賢者ライオンタイプは、恋愛でも感情より理解を重視。相手をよく観察し、冷静に関係を築こうとします。感情表現は控えめですが、信頼が深まるほど愛情は安定。言葉や態度で気持ちを示すことを意識すると、相手に安心感を与えられる恋愛になります。"
    ],
    "best": [
      "wisdom_rabbit",
      "moon_cat"
    ],
    "cardSummary": "理解と設計で恋を育てる戦略型。感情表現は控えめでも誠実。言葉や態度で安心を示すと、安定した信頼関係が深まる。正解探しより気持ちの共有を増やすほど、距離が縮まる。"
  },
  "shogun_lion": {
    "label": "⚔️ 将軍ライオン｜Shogun Lion",
    "img": "assets/shogun_lion.png",
    "catch": "現場を動かす指揮官",
    "personality": [
      "行動と結果が最優先。現場感覚が鋭い実行型",
      "決めたら即実行で、停滞を動かせる推進力がある",
      "責任感が強く、修羅場でも粘れる",
      "強く見られがちだが、内側は仲間思いで守る意識が強い",
      "スピードが武器。反面、急ぎすぎる時は一呼吸が効く"
    ],
    "work": [
      "プロジェクト推進・現場責任者・運用改善で強い",
      "スケジュール管理、現場の采配、トラブル対応が得意",
      "『やると決めたことを終わらせる力』が最大の武器",
      "評価されるコツ：共有・相談のタイミングを早めると信頼が爆上がり"
    ],
    "love": [
      "将軍ライオンタイプは、恋愛でも行動で愛を示すタイプ。口数は少なくても、守る・支える姿勢が強いです。ただし強引に見られやすい一面もあるため、相手の意見を聞く姿勢を持つことで関係はさらに良好に。頼られるほど、愛情が深まるタイプです。"
    ],
    "best": [
      "forest_rabbit",
      "thunder_dog"
    ],
    "cardSummary": "行動で愛を示す実行型。守る意識が強いが強引に見られがち。相手の意見を聞く余白を作ると、頼もしさが魅力になる。結論の前に一言『どう思う？』を足すだけで恋が安定。落ち着きが鍵。"
  }
};

const QUESTIONS = [
  {
    "id": "q1",
    "text": "初対面の場で、つい出やすい自分は？",
    "options": [
      {
        "key": "A",
        "text": "周りを観察してから動く",
        "score": {
          "I": 2,
          "T": 1,
          "sub": "wisdom_rabbit"
        }
      },
      {
        "key": "B",
        "text": "空気を壊さないように振る舞う",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "mist_cat"
        }
      },
      {
        "key": "C",
        "text": "自分から話題を振る",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "festival_dog"
        }
      },
      {
        "key": "D",
        "text": "全体の流れを見てまとめる",
        "score": {
          "E": 2,
          "T": 1,
          "sub": "king_lion"
        }
      }
    ]
  },
  {
    "id": "q2",
    "text": "何かを決める時の基準に近いのは？",
    "options": [
      {
        "key": "A",
        "text": "直感やフィーリング",
        "score": {
          "F": 2,
          "I": 1,
          "sub": "dream_cat"
        }
      },
      {
        "key": "B",
        "text": "無難で安心な選択",
        "score": {
          "T": 2,
          "I": 1,
          "sub": "forest_rabbit"
        }
      },
      {
        "key": "C",
        "text": "ワクワクする方",
        "score": {
          "F": 2,
          "E": 1,
          "sub": "thunder_dog"
        }
      },
      {
        "key": "D",
        "text": "成果が出そうな方",
        "score": {
          "T": 2,
          "E": 1,
          "sub": "sage_lion"
        }
      }
    ]
  },
  {
    "id": "q3",
    "text": "褒められて一番嬉しいのは？",
    "options": [
      {
        "key": "A",
        "text": "センスがいい",
        "score": {
          "F": 2,
          "I": 1,
          "sub": "moon_cat"
        }
      },
      {
        "key": "B",
        "text": "気が利く",
        "score": {
          "F": 1,
          "T": 1,
          "I": 1,
          "sub": "wind_rabbit"
        }
      },
      {
        "key": "C",
        "text": "元気をもらえる",
        "score": {
          "F": 2,
          "E": 1,
          "sub": "sun_dog"
        }
      },
      {
        "key": "D",
        "text": "任せて安心",
        "score": {
          "T": 2,
          "E": 1,
          "sub": "shogun_lion"
        }
      }
    ]
  },
  {
    "id": "q4",
    "text": "一番ストレスを感じるのは？",
    "options": [
      {
        "key": "A",
        "text": "自分のペースを乱される",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "moon_cat"
        }
      },
      {
        "key": "B",
        "text": "人間関係がギスギス",
        "score": {
          "I": 1,
          "F": 2,
          "sub": "mist_cat"
        }
      },
      {
        "key": "C",
        "text": "刺激がなく退屈",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "thunder_dog"
        }
      },
      {
        "key": "D",
        "text": "方向性が見えない",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "king_lion"
        }
      }
    ]
  },
  {
    "id": "q5",
    "text": "休みの日の理想は？",
    "options": [
      {
        "key": "A",
        "text": "ひとりで没頭",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "dream_cat"
        }
      },
      {
        "key": "B",
        "text": "気心知れた人と穏やかに",
        "score": {
          "I": 1,
          "F": 1,
          "T": 1,
          "sub": "forest_rabbit"
        }
      },
      {
        "key": "C",
        "text": "外に出て予定を詰める",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "festival_dog"
        }
      },
      {
        "key": "D",
        "text": "未来のための準備や計画",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "sage_lion"
        }
      }
    ]
  },
  {
    "id": "q6",
    "text": "トラブルが起きた時の動きは？",
    "options": [
      {
        "key": "A",
        "text": "一度整理して考える",
        "score": {
          "I": 1,
          "T": 2,
          "sub": "wisdom_rabbit"
        }
      },
      {
        "key": "B",
        "text": "周囲の気持ちを優先",
        "score": {
          "I": 1,
          "F": 2,
          "sub": "mist_cat"
        }
      },
      {
        "key": "C",
        "text": "まず行動して流れを変える",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "sun_dog"
        }
      },
      {
        "key": "D",
        "text": "判断して指示を出す",
        "score": {
          "E": 2,
          "T": 1,
          "sub": "shogun_lion"
        }
      }
    ]
  },
  {
    "id": "q7",
    "text": "人との距離感で近いのは？",
    "options": [
      {
        "key": "A",
        "text": "深く狭く",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "moon_cat"
        }
      },
      {
        "key": "B",
        "text": "穏やかに広く",
        "score": {
          "I": 1,
          "F": 1,
          "T": 1,
          "sub": "wind_rabbit"
        }
      },
      {
        "key": "C",
        "text": "ノリで一気に縮める",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "festival_dog"
        }
      },
      {
        "key": "D",
        "text": "役割がある関係が楽",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "king_lion"
        }
      }
    ]
  },
  {
    "id": "q8",
    "text": "仕事や作業で得意なのは？",
    "options": [
      {
        "key": "A",
        "text": "発想・表現",
        "score": {
          "F": 2,
          "I": 1,
          "sub": "dream_cat"
        }
      },
      {
        "key": "B",
        "text": "継続・サポート",
        "score": {
          "T": 1,
          "I": 1,
          "F": 1,
          "sub": "forest_rabbit"
        }
      },
      {
        "key": "C",
        "text": "推進・スピード",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "thunder_dog"
        }
      },
      {
        "key": "D",
        "text": "管理・判断",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "sage_lion"
        }
      }
    ]
  },
  {
    "id": "q9",
    "text": "周囲から見られがちな役割は？",
    "options": [
      {
        "key": "A",
        "text": "独特な人",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "dream_cat"
        }
      },
      {
        "key": "B",
        "text": "優しい人",
        "score": {
          "I": 1,
          "F": 2,
          "sub": "mist_cat"
        }
      },
      {
        "key": "C",
        "text": "明るい人",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "sun_dog"
        }
      },
      {
        "key": "D",
        "text": "しっかり者",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "shogun_lion"
        }
      }
    ]
  },
  {
    "id": "q10",
    "text": "恋愛や人間関係で大切なのは？",
    "options": [
      {
        "key": "A",
        "text": "自由と理解",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "moon_cat"
        }
      },
      {
        "key": "B",
        "text": "安心と信頼",
        "score": {
          "I": 1,
          "T": 2,
          "sub": "forest_rabbit"
        }
      },
      {
        "key": "C",
        "text": "楽しさと熱量",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "sun_dog"
        }
      },
      {
        "key": "D",
        "text": "尊敬と成長",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "king_lion"
        }
      }
    ]
  },
  {
    "id": "q11",
    "text": "うまくいっている時の自分は？",
    "options": [
      {
        "key": "A",
        "text": "世界観に浸っている",
        "score": {
          "I": 2,
          "F": 1,
          "sub": "dream_cat"
        }
      },
      {
        "key": "B",
        "text": "周囲と調和している",
        "score": {
          "I": 1,
          "F": 1,
          "T": 1,
          "sub": "wind_rabbit"
        }
      },
      {
        "key": "C",
        "text": "人を巻き込んでいる",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "festival_dog"
        }
      },
      {
        "key": "D",
        "text": "物事を前に進めている",
        "score": {
          "E": 2,
          "T": 1,
          "sub": "shogun_lion"
        }
      }
    ]
  },
  {
    "id": "q12",
    "text": "「自分らしい」と感じる瞬間は？",
    "options": [
      {
        "key": "A",
        "text": "静かに考えている時",
        "score": {
          "I": 1,
          "T": 2,
          "sub": "wisdom_rabbit"
        }
      },
      {
        "key": "B",
        "text": "誰かの役に立てた時",
        "score": {
          "I": 1,
          "T": 1,
          "F": 1,
          "sub": "forest_rabbit"
        }
      },
      {
        "key": "C",
        "text": "動いて結果が出た時",
        "score": {
          "E": 2,
          "F": 1,
          "sub": "thunder_dog"
        }
      },
      {
        "key": "D",
        "text": "判断して導いた時",
        "score": {
          "E": 1,
          "T": 2,
          "sub": "king_lion"
        }
      }
    ]
  }
];

function decideType(score) {
  const IE = (score.E || 0) - (score.I || 0);
  const FT = (score.T || 0) - (score.F || 0);
  const energy = IE >= 0 ? "E" : "I";
  const basis = FT >= 0 ? "T" : "F";

  let candidates = [];
  if (energy==="I" && basis==="F") candidates = ["moon_cat","dream_cat","mist_cat"];
  if (energy==="I" && basis==="T") candidates = ["forest_rabbit","wind_rabbit","wisdom_rabbit"];
  if (energy==="E" && basis==="F") candidates = ["sun_dog","thunder_dog","festival_dog"];
  if (energy==="E" && basis==="T") candidates = ["king_lion","sage_lion","shogun_lion"];

  let best = candidates[0];
  let bestV = -1;
  candidates.forEach(k=>{
    const v = (score.subScores && score.subScores[k]) ? score.subScores[k] : 0;
    if (v > bestV) { bestV = v; best = k; }
  });
  return best;
}

function parseQuery(){
  const q = new URLSearchParams(location.search);
  const obj = {};
  for (const [k,v] of q.entries()) obj[k]=v;
  return obj;
}

function baseUrl(){
  const u = new URL(location.href);
  u.hash = "";
  u.search = "";
  return u.toString().replace(/\/[^\/]*$/, "");
}

async function copyText(text){
  try{ await navigator.clipboard.writeText(text); return true; }
  catch(e){
    const ta = document.createElement("textarea");
    ta.value=text;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand("copy");
    document.body.removeChild(ta);
    return true;
  }
}

function prettyCompatibility(a, b){
  // Returns a stable percent + stars + message (100-150 Japanese chars)
  const mk = (percent, msg)=>{
    const stars = percent>=90 ? "★★★★★" : percent>=75 ? "★★★★☆" : percent>=60 ? "★★★☆☆" : "★★☆☆☆";
    return {percent, stars, msg};
  };

  if (a===b){
    return mk(92, "同タイプ同士は価値観が近く、安心感が抜群。迷った時も同じ方向を向きやすい相性です。得意と苦手を言葉にして役割を少し分けると依存せずに成長でき、照れずに感謝を伝えるほど長く心地よく続きます。困った時は一緒に休むのも◎。");
  }
  const bestA = TYPES[a]?.best || [];
  const bestB = TYPES[b]?.best || [];
  const aLikesB = bestA.includes(b);
  const bLikesA = bestB.includes(a);

  if (aLikesB && bLikesA){
    return mk(88, "お互いの強みが自然に噛み合う“相互ベスト”相性。片方のひらめきがもう片方の実行力に変わり、前に進むスピードが上がります。意見が違う時は結論より気持ちを先に共有し、ねぎらいを添えると信頼が一段深まります。");
  }
  if (aLikesB || bLikesA){
    return mk(74, "片方の得意がもう片方の安心につながる伸びる相性。最初はテンポの差を感じても、得意分野を任せ合うと一気に仲が深まります。約束や連絡の頻度を先に決め、できたことを褒め合うと気持ちがすれ違いにくく長続きします。");
  }
  return mk(62, "刺激があって学びが多い相性。考え方やこだわりが違う分、相手の視点を取り入れると世界が広がります。衝突しそうな時は“目的は同じ”を確認して一呼吸。担当や期限を決めて進めると、驚くほどスムーズになります。");
}

