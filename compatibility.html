<!doctype html>
<html lang="ja">
<head>
    <meta name="robots" content="noimageindex">
<meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­</title>
  <meta name="description" content="è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã‚’è¡¨ã™ã€Œ12ã‚¿ã‚¤ãƒ—å‹•ç‰©ã‚­ãƒ£ãƒ©ã€ãŒã‚ã‹ã‚‹è¨ºæ–­ã€‚æ€§æ ¼ãƒ»ä»•äº‹ãƒ»æ‹æ„›ã®å‚¾å‘ã«åŠ ãˆã¦ã€ç›¸æ€§è¨ºæ–­ã‚„çµæœã‚«ãƒ¼ãƒ‰ã®ä¿å­˜ã‚‚ã§ãã¾ã™ã€‚">
  <link rel="canonical" href="https://kajisananimal.github.io/12an/compatibility.html">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700;900&family=Zen+Maru+Gothic:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" type="image/png" href="assets/favicon-32.png">
  <link rel="apple-touch-icon" href="assets/icon-192.png">



<script type="application/ld+json">{"@context": "https://schema.org", "@type": "WebSite", "name": "ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­", "description": "è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã‚’è¡¨ã™ã€Œ12ã‚¿ã‚¤ãƒ—å‹•ç‰©ã‚­ãƒ£ãƒ©ã€ãŒã‚ã‹ã‚‹è¨ºæ–­ã€‚æ€§æ ¼ãƒ»ä»•äº‹ãƒ»æ‹æ„›ã®å‚¾å‘ã«åŠ ãˆã¦ã€ç›¸æ€§è¨ºæ–­ã‚„çµæœã‚«ãƒ¼ãƒ‰ã®ä¿å­˜ã‚‚ã§ãã¾ã™ã€‚", "inLanguage": "ja", "url": "./"}</script>

    <!-- Open Graph / Twitter (for LINE, SNS share preview) -->




    <!-- Open Graph / Twitter (for LINE, SNS share preview) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­">
    <meta property="og:description" content="è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã‚’è¡¨ã™ã€12ã‚¿ã‚¤ãƒ—å‹•ç‰©ã‚­ãƒ£ãƒ©ã€ãŒã‚ã‹ã‚‹è¨ºæ–­ã€‚çµæœã¯ã‚·ã‚§ã‚¢ï¼†ç›¸æ€§è¨ºæ–­ã‚‚ã§ãã‚‹ã‚ˆã€‚">
      <meta property="og:url" content="https://kajisananimal.github.io/12an/compatibility.html">
<meta property="og:image" content="https://kajisananimal.github.io/12an/assets/ogp_home.png?v=20">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­">
    <meta name="twitter:description" content="è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã‚’è¡¨ã™ã€12ã‚¿ã‚¤ãƒ—å‹•ç‰©ã‚­ãƒ£ãƒ©ã€ãŒã‚ã‹ã‚‹è¨ºæ–­ã€‚çµæœã¯ã‚·ã‚§ã‚¢ï¼†ç›¸æ€§è¨ºæ–­ã‚‚ã§ãã‚‹ã‚ˆã€‚">
    <meta name="twitter:image" content="https://kajisananimal.github.io/12an/assets/ogp_x.png?v=20">
    
  <script src="https://cdn.jsdelivr.net/npm/html2canvas.4.1/dist/html2canvas.min.js"></script>
  <script src="saveImage.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="badge">ç›¸</div>
        <div>
          <h1>ç›¸æ€§ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­</h1>
          <div class="subtitle">2äººã®ã‚¿ã‚¤ãƒ—ã‚’é¸ã¶ã ã‘</div>
        </div>
      </div>
      <nav class="nav">
        <a href="index.html">ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­</a>
        <a href="compatibility.html">ç›¸æ€§</a>
      </nav>
    </header>

    <section class="card">
      <div class="compat-grid">
        <div>
          <h2 style="margin:0 0 10px;">ã‚ãªãŸ</h2>
          <select id="me"></select>
          <div class="result-wrap" style="margin-top:12px;">
            <img id="meImg" src="" alt="ã‚ãªãŸã®ç”»åƒ" />
            <div>
              <div class="type-pill" id="meLabel"></div>
              <div class="small" id="meCatch"></div>
            </div>
          </div>
        </div>

        <div>
          <h2 style="margin:0 0 10px;">ç›¸æ‰‹</h2>
          <select id="you"></select>
          <div class="result-wrap" style="margin-top:12px;">
            <img id="youImg" src="" alt="ç›¸æ‰‹ã®ç”»åƒ" />
            <div>
              <div class="type-pill" id="youLabel"></div>
              <div class="small" id="youCatch"></div>
            </div>
          </div>
        </div>
      </div>


      <div class="actions" style="justify-content:center;margin-top:14px;">
        <button class="primary" id="btnDecide">ã“ã®çµ„ã¿åˆã‚ã›ã§æ±ºå®š</button>
      </div>

      <hr class="sep" />

      <div class="card" id="compatCard" style="padding:14px;">
        <h2 style="margin:0 0 8px;">ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­çµæœ</h2>
        <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:center;">
          <div class="type-pill" id="grade"></div>
          <div class="stars" id="stars"></div>
          <div class="small" id="msg"></div>
        </div>
        <div class="actions" style="margin-top:12px;">
          <button class="primary" id="btnSaveCompat">ç›¸æ€§ã‚«ãƒ¼ãƒ‰ã‚’ä¿å­˜</button>
          <button class="secondary" id="btnCopy">ç›¸æ€§URLã‚’ã‚³ãƒ”ãƒ¼</button>
          <a class="btn secondary" id="btnShare" target="_blank" rel="noopener">Xã§ã‚·ã‚§ã‚¢</a>
          <a class="btn ghost" href="index.html">ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­ã¸æˆ»ã‚‹</a>
        </div>
        <div class="footer" id="urlLine"></div>
      </div>
    </section>
  </div>

<script src="app.js"></script>
<script>
  const selMe = document.getElementById("me");
  const selYou = document.getElementById("you");
  const btnDecide = document.getElementById("btnDecide");

  function addOptions(sel){
    sel.innerHTML = "";
    Object.entries(TYPES).forEach(([key, t])=>{
      const o = document.createElement("option");
      o.value = key;
      o.textContent = t.label;
      sel.appendChild(o);
    });
  }
  addOptions(selMe);
  addOptions(selYou);

  const q = parseQuery();
  if (q.me && TYPES[q.me]) selMe.value = q.me;
  if (q.you && TYPES[q.you]) selYou.value = q.you;

  const $ = (id)=>document.getElementById(id);

  // Selection preview (always updates)
  function renderSelections(){
    const meKey = selMe.value;
    const youKey = selYou.value;
    const me = TYPES[meKey];
    const you = TYPES[youKey];

    $("meImg").src = me.img;
    $("meLabel").textContent = me.label;
    $("meCatch").textContent = me.catch;

    $("youImg").src = you.img;
    $("youLabel").textContent = you.label;
    $("youCatch").textContent = you.catch;

    // When selection changes, ask user to decide again
    $("grade").textContent = "ğŸ’– ç›¸æ€§ï¼šâ€”";
    $("stars").textContent = "â€”";
    $("msg").textContent = "ã‚¿ã‚¤ãƒ—ã‚’é¸ã‚“ã ã‚‰ã€Œæ±ºå®šã€ã‚’æŠ¼ã—ã¦ã­";
    $("urlLine").textContent = "";

    // keep URL updated for reload, but don't show result until decide
    const newUrl = `?me=${encodeURIComponent(meKey)}&you=${encodeURIComponent(youKey)}`;
    history.replaceState(null, "", newUrl);
  }

  // Result render (only when decided)
  function renderResult(){
    const meKey = selMe.value;
    const youKey = selYou.value;
    const me = TYPES[meKey];
    const you = TYPES[youKey];

    const r = prettyCompatibility(meKey, youKey);
    $("grade").textContent = `ğŸ’– ç›¸æ€§ï¼š${r.percent}%`;
    $("stars").textContent = r.stars;
    $("msg").textContent = r.msg;

    const url = `${baseUrl()}/compatibility.html?me=${encodeURIComponent(meKey)}&you=${encodeURIComponent(youKey)}`;
    $("urlLine").textContent = url;

    $("btnCopy").onclick = async ()=>{
      await copyText(url);
      $("btnCopy").textContent = "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼";
      setTimeout(()=>$("btnCopy").textContent="ç›¸æ€§URLã‚’ã‚³ãƒ”ãƒ¼", 1200);
    };

    const shareText = `ç›¸æ€§ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­ï¼š${me.label} Ã— ${you.label}
ç›¸æ€§ï¼š${r.percent}% ${r.stars}
${r.msg}
ğŸ‘‡ã©ã†ã¶ã¤12ã‚¿ã‚¤ãƒ—è¨ºæ–­ã¯ã“ã¡ã‚‰`;
    $("btnShare").href =
      `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(baseUrl()+"/index.html")}`;
  }

  // Decide button
  if (btnDecide){
    btnDecide.addEventListener("click", ()=>{
      renderResult();
      btnDecide.textContent = "ã“ã®çµ„ã¿åˆã‚ã›ã§æ±ºå®š âœ“";
      setTimeout(()=>btnDecide.textContent="ã“ã®çµ„ã¿åˆã‚ã›ã§æ±ºå®š", 1200);
    });
  }

  // Save compatibility card to album
  const btnSave = $("btnSaveCompat");
  if (btnSave){
    btnSave.addEventListener("click", async ()=>{
      const old = btnSave.textContent;
      btnSave.textContent = "ä¿å­˜æº–å‚™ä¸­â€¦";
      btnSave.disabled = true;
      try{
        const meKey = selMe.value;
        const youKey = selYou.value;
        await window.__saveCardToImage("compatCard", `12type_compat_${meKey}_${youKey}.png`);
        btnSave.textContent = "ä¿å­˜ã§ãã¾ã—ãŸï¼";
        setTimeout(()=>{ btnSave.textContent = old; btnSave.disabled = false; }, 1400);
      }catch(e){
        console.error(e);
        alert("ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
        btnSave.textContent = old;
        btnSave.disabled = false;
      }
    });
  }

  // events
  selMe.addEventListener("change", renderSelections);
  selYou.addEventListener("change", renderSelections);

  renderSelections();

  // If URL already has both params, auto-render result once (so shared links show result)
  if (q.me && q.you && TYPES[q.me] && TYPES[q.you]) {
    renderResult();
  }
</script>

</body>
</html>
